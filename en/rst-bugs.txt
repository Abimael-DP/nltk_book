.. -*- mode: rst -*-
.. include:: ../definitions.txt

--------
RST Bugs
--------

Building PDF and HTML files
---------------------------

The makefile runs ``rst.py --ref`` more often than needed.
Each time an individual ``.txt`` source file is touched,
a make extracts references from all other source files.

Gloss formatting
----------------

The following produces output with a wrapped item; how can we widen the cells?

   .. gloss::
      the | dog       |run-s
          | dog.3.SG  |run-3.SG

Pylisting numbering
-------------------

Pylisting numbers that occur in the title of the listing leave out chapter numbers.
A reference to a listing from the text includes the chapter number.

Subexamples
-----------

.. _thisdog:
.. ex::
   .. _thisdoga:
   .. ex::
      this dog
   .. _thisdogb:
   .. ex::
      \*these dog

|nopar| It would be better if this could be rendered along the following
lines::

  (1) a.  this dog
      b. *these dog


|nopar| However, the following cross-references are fine as they stand:
examples thisdog_ contains thisdoga_ and thisdogb_.


Gloss Directive
---------------

In the PDF output, the
example number should be lined up with the top of the table, rather
than the centre. (Also, seems to be incorrectly coming out as '(2a)'
rather than just '(2)'.)

.. ex::
   .. gloss::
      un                         | cuadro  | hermos-o
      INDEF.SG.MASC              | picture | beautiful-SG.MASC
      'a beautiful picture'         


|nopar| In the HTML output, there is too much interline space when the
gloss is embedded inside an exercise:

#. |soso| Augment agcfg1_ so that it will correctly describe the following
   Spanish noun phrases:

    .. ex::
       .. gloss::
	  un                         | cuadro  | hermos-o
	  INDEF.SG.MASC              | picture | beautiful-SG.MASC
	  'a beautiful picture'               


AVMs
----

The following AVM doesn't get parsed properly. (Not too serious --- we
could drop this example if fixing it is tricky.)

.. _reentrant03:
.. ex::
      .. avm:: 

	 [ A = (1) [ ] ]
	 [ B = (2) [ ] ]
	 [ C -> (1)    ]
	 [ D -> (2)    ]


Pylisting
---------

#. Clicking on a tag hyperlink in running text takes you to the first page of the PDF file
#. Tag result_ now appears in doctest block, but test/doctest_driver.py will need to be tweaked

.. pylisting:: foo
   :caption: Pylisting
   
    >>> a = 1       # [_assignment]
    >>> a
    1               # [_result]


Unicode Problem
---------------

Not specifically a problem with rst, but ...

.. ex::
    `FS`:math:\ :subscript:`0` |SquareIntersection| `FS`:math:\
    :subscript:`1` = `FS`:math:\ :subscript:`1` |SquareIntersection|
    `FS`:math:\ :subscript:`0`.


Overstrict parsing of Bib file
------------------------------

The following entry in book.bib::

 @Book{Nerbonne1994GHD,
   editor = 	 {John Nerbonne and Klaus Netter and Carl Pollard},
   title = 	 {German in {Head-Driven Phrase Structure Grammar}},
   publisher = 	 {CSLI},
   year = 	 1994,
   address = 	 {Stanford, CA}}

triggers a fatal error::

   ...
   File "../rst.py", line 514, in apply
     bibliography = self.read_bibinfo(BIBTEX_FILE)
   File "../rst.py", line 553, in read_bibinfo
     if bibliography[key][0] is None: warning('no author found:', key)

However, it should be fine to have an edited collection as a book entry.
