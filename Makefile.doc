# NLTK-LITE: Tutorial Makefile
#
# Copyright (C) 2001-2005 University of Pennsylvania
# Author: Steven Bird <sb@csse.unimelb.edu.au>
#         Edward Loper <edloper@gradient.cis.upenn.edu>
# URL: <http://nltk.sf.net>
# For license information, see LICENSE.TXT

TUTORIALS = index.txt  preface.txt  introduction.txt  programming.txt  words.txt  tag.txt  parse.txt  chunk.txt  chart.txt  pcfg.txt  field.txt  projects.txt

PDF := $(TUTORIALS:.txt=.pdf)
HTML := $(TUTORIALS:.txt=.html)
ERRS := $(TUTORIALS:.txt=.errs)

PYTHON = python2.4
PDFLATEX = TEXINPUTS=".:..:" pdflatex -halt-on-error
RST = ../rst.py
RST2HTML = $(RST) --html
RST2LATEX = $(RST) --latex

WEB = stevenbird@shell.sourceforge.net:/home/groups/n/nl/nltk/htdocs/lite
RSYNC_OPTS = -arvz -e ssh --relative --cvs-exclude

CSS_STYLESHEET_PATH = ../default.css
LATEX_STYLESHEET_PATH = ../definitions.sty

.SUFFIXES: .txt .html .pdf .errs

help: usage
usage:
	@echo "Usage:"
	@echo "    make all         -- Build HTML & PDF output"
	@echo "    make html        -- Build HTML output"
	@echo "    make pdf         -- Build PDF output"
	@echo "    make errs        -- Run doctest to generate .errs files"
	@echo "    make clean       -- Remove all built files"

all: $(HTML) $(PDF) clean_up
html: $(HTML)
pdf: $(PDF)
errs: $(ERRS)
	ls -l $(ERRS)

clean:
	rm -f $(PDF) $(HTML) $(ERRS) *.tex *.log *.aux *.out *.errs

clean_up:
	rm -f *.log *.aux *.tex *.out *.errs

.txt.html:
	$(RST2HTML) $<

.txt.tex:
	$(RST2LATEX) $<

.tex.pdf:
	$(PDFLATEX) $<
	$(PDFLATEX) $<

.txt.errs:
	$(PYTHON) -c "import doctest; doctest.testfile('$<', optionflags=doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS)" > $@

rsync-en:
	rsync $(RSYNC_OPTS) . $(WEB)/doc/en/
